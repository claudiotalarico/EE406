;; file: .emacs
;; customize emacs

;; Suppress annoying startup msg.
(setq inhibit-startup-message t)        

;; printing defaults
(setq ps-paper-type 'letter)
(setq ps-font-size 8)
(setq ps-header-title-font-size 10)
(setq ps-header-font-size 8)
(setq ps-header-lines 1) ;; show only filename and page number

;; Command to print portrait
(defun print-buffer-one ()
  "Output a portrait postscript file."
  (interactive)
  (setq name (concat (file-name-sans-extension buffer-file-name) ".ps"))
  (ps-print-buffer-with-faces name))
  ;; the following line calls a mac app
  ;; on Windows OS comment it out and add an "ending" parentesis to the
  ;; lst uncommented line above
  ;; (shell-command (format "open -a Preview %s" (shell-quote-argument name))))

;; Command to print landscape 
(defun print-buffer-land ()
   "Output a landscape postscript file."
   (interactive)
   (setq ps-paper-type 'letter
    ; ps-print-header nil ;; turn off header
    ps-header-lines 1     ;; show only filename and page number
    ps-landscape-mode t
    ps-number-of-columns 1)
    (setq name (concat (file-name-sans-extension buffer-file-name) ".ps"))
    (ps-print-buffer-with-faces name))

;; Command to print 2 columns, landscape, size 6 
;; (prints column 0-78, lines 1 to 70)
(defun print-buffer-two ()
   "Output a 2 columns landscape postscript file ."
   (interactive)
   (setq ps-paper-type 'letter
    ps-font-size 6.0
    ; ps-print-header nil ;; turn off header
    ps-header-lines 1     ;; show only filename and page number
    ps-landscape-mode t
    ps-header-title-font-size 8
    ps-header-font-size 6
    ps-number-of-columns 2)
    (setq name (concat (file-name-sans-extension buffer-file-name) ".ps"))
    (ps-print-buffer-with-faces name))
;; need further tuning to leave less margins and fit more text

;; Bind the default print command to the f1 key
(global-set-key [f1] 'print-buffer-one)

;; Bind the landscape print command to the f2 key
(global-set-key [f2] 'print-buffer-land)

;; Bind the two columns landscape command to the f3 key
(global-set-key [f3] 'print-buffer-two)
